{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"database/sql\"\n\t\"fmt\"\n\t\"net/http\"\n)\n\nfunc GetUser(w http.ResponseWriter, r *http.Request) {\n\tuserID := r.URL.Query().Get(\"id\")\n\tdb, _ := sql.Open(\"mysql\", \"user:pass@/dbname\")\n\tquery := \"SELECT * FROM users WHERE id = '\" + userID + \"'\"\n\trows, _ := db.Query(query)\n\tdefer rows.Close()\n\tfmt.Fprintf(w, \"User found\")\n}"}, "outputs": {"expected_findings": ["sql_injection", "missing_input_validation"]}, "metadata": {"category": "security", "complexity": "high"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"net/http\"\n)\n\nfunc RenderPage(w http.ResponseWriter, r *http.Request) {\n\tusername := r.URL.Query().Get(\"name\")\n\thtml := \"<html><body><h1>Welcome \" + username + \"</h1></body></html>\"\n\tfmt.Fprintf(w, html)\n}"}, "outputs": {"expected_findings": ["xss", "missing_input_sanitization"]}, "metadata": {"category": "security", "complexity": "medium"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"os/exec\"\n\t\"net/http\"\n)\n\nfunc ExecuteCommand(w http.ResponseWriter, r *http.Request) {\n\tcmd := r.URL.Query().Get(\"cmd\")\n\tout, err := exec.Command(\"sh\", \"-c\", cmd).Output()\n\tif err != nil {\n\t\tfmt.Fprintf(w, \"Error: %v\", err)\n\t\treturn\n\t}\n\tfmt.Fprintf(w, \"Output: %s\", out)\n}"}, "outputs": {"expected_findings": ["command_injection", "missing_input_validation"]}, "metadata": {"category": "security", "complexity": "high"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"net/http\"\n)\n\nfunc Login(w http.ResponseWriter, r *http.Request) {\n\tusername := r.FormValue(\"username\")\n\tpassword := r.FormValue(\"password\")\n\t\n\tif username == \"admin\" && password == \"admin123\" {\n\t\tw.Write([]byte(\"Login successful\"))\n\t} else {\n\t\tw.Write([]byte(\"Login failed\"))\n\t}\n}"}, "outputs": {"expected_findings": ["hardcoded_credentials", "missing_authentication"]}, "metadata": {"category": "security", "complexity": "medium"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"net/http\"\n)\n\nvar sessions = make(map[string]string)\n\nfunc CreateSession(w http.ResponseWriter, r *http.Request) {\n\tsessionID := r.URL.Query().Get(\"session_id\")\n\tuserID := r.URL.Query().Get(\"user_id\")\n\tsessions[sessionID] = userID\n\tw.Write([]byte(\"Session created\"))\n}\n\nfunc GetSession(w http.ResponseWriter, r *http.Request) {\n\tsessionID := r.URL.Query().Get(\"session_id\")\n\tif userID, ok := sessions[sessionID]; ok {\n\t\tw.Write([]byte(\"User: \" + userID))\n\t}\n}"}, "outputs": {"expected_findings": ["session_fixation", "missing_session_validation"]}, "metadata": {"category": "security", "complexity": "medium"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"database/sql\"\n\t\"fmt\"\n)\n\nfunc GetAllUsers(userIDs []int) {\n\tdb, _ := sql.Open(\"mysql\", \"user:pass@/dbname\")\n\tdefer db.Close()\n\t\n\tfor _, id := range userIDs {\n\t\tquery := \"SELECT * FROM users WHERE id = ?\"\n\t\trows, _ := db.Query(query, id)\n\t\tdefer rows.Close()\n\t\tfmt.Println(\"User:\", id)\n\t}\n}"}, "outputs": {"expected_findings": ["n_plus_one_query", "missing_batch_query"]}, "metadata": {"category": "performance", "complexity": "medium"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"sync\"\n)\n\nvar cache = make(map[string]string)\nvar mu sync.Mutex\n\nfunc AddToCache(key, value string) {\n\tmu.Lock()\n\tdefer mu.Unlock()\n\tcache[key] = value\n}\n\nfunc GetFromCache(key string) string {\n\tmu.Lock()\n\tdefer mu.Unlock()\n\treturn cache[key]\n}"}, "outputs": {"expected_findings": ["memory_leak", "unbounded_cache_growth"]}, "metadata": {"category": "performance", "complexity": "medium"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"time\"\n)\n\nfunc ProcessItems(items []string) {\n\tfor _, item := range items {\n\t\ttime.Sleep(100 * time.Millisecond)\n\t\tfmt.Println(\"Processing:\", item)\n\t}\n}"}, "outputs": {"expected_findings": ["blocking_operations", "missing_concurrency"]}, "metadata": {"category": "performance", "complexity": "low"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"context\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"time\"\n)\n\nfunc FetchData(url string) (string, error) {\n\tresp, err := http.Get(url)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\tdefer resp.Body.Close()\n\treturn \"data\", nil\n}\n\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n\tdata, _ := FetchData(\"https://api.example.com/data\")\n\tfmt.Fprintf(w, \"Data: %s\", data)\n}"}, "outputs": {"expected_findings": ["missing_timeout", "missing_context_cancellation"]}, "metadata": {"category": "performance", "complexity": "medium"}}
{"inputs": {"language": "go", "code": "package main\n\nimport (\n\t\"sync\"\n)\n\ntype Cache struct {\n\tmu   sync.Mutex\n\tdata map[string]string\n}\n\nfunc (c *Cache) Get(key string) string {\n\tc.mu.Lock()\n\tdefer c.mu.Unlock()\n\treturn c.data[key]\n}\n\nfunc (c *Cache) Set(key, value string) {\n\tc.mu.Lock()\n\tdefer c.mu.Unlock()\n\tc.data[key] = value\n}"}, "outputs": {"expected_findings": ["inefficient_locking", "should_use_rwmutex"]}, "metadata": {"category": "performance", "complexity": "medium"}}
