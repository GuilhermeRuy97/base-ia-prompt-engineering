{"inputs": {"code": "package main\nimport (\n  \"net/http\"\n  \"io/ioutil\"\n)\n\nfunc fetch(url string) string {\n  resp, _ := http.Get(url)\n  body, _ := ioutil.ReadAll(resp.Body)\n  defer resp.Body.Close()\n  return string(body)\n}"}, "outputs": {"expected_findings": [{"type": "missing_timeout", "severity": "medium"}, {"type": "ignored_error", "severity": "high"}, {"type": "missing_status_check", "severity": "low"}]}, "metadata": {"category": "robustness", "difficulty": "medium"}}
{"inputs": {"code": "package repo\n\nimport (\n  \"database/sql\"\n  \"fmt\"\n)\n\nfunc GetUser(db *sql.DB, username string) (int, error) {\n  query := fmt.Sprintf(\"SELECT id FROM users WHERE username = '%s'\", username)\n  row := db.QueryRow(query)\n  var id int\n  if err := row.Scan(&id); err != nil {\n    return 0, err\n  }\n  return id, nil\n}"}, "outputs": {"expected_findings": [{"type": "sql_injection", "severity": "critical"}, {"type": "missing_timeout", "severity": "medium"}]}, "metadata": {"category": "security", "difficulty": "high"}}
{"inputs": {"code": "package main\n\nimport \"database/sql\"\n\nfunc GetAllUsers(db *sql.DB) []User {\n  users := []User{}\n  ids := []int{1, 2, 3, 4, 5}\n  for _, id := range ids {\n    row := db.QueryRow(\"SELECT * FROM users WHERE id = ?\", id)\n    var u User\n    row.Scan(&u.ID, &u.Name)\n    users = append(users, u)\n  }\n  return users\n}"}, "outputs": {"expected_findings": [{"type": "n_plus_1_query", "severity": "high"}, {"type": "ignored_error", "severity": "medium"}]}, "metadata": {"category": "performance", "difficulty": "medium"}}
{"inputs": {"code": "package api\n\nimport (\n  \"context\"\n  \"time\"\n)\n\nfunc ProcessBatch(ctx context.Context, items []string) {\n  for _, item := range items {\n    time.Sleep(5 * time.Second)\n    result := heavyComputation(item)\n    saveToDatabase(result)\n  }\n}"}, "outputs": {"expected_findings": [{"type": "blocking_operation", "severity": "high"}, {"type": "no_context_check", "severity": "medium"}, {"type": "sequential_processing", "severity": "high"}]}, "metadata": {"category": "performance", "difficulty": "high"}}
{"inputs": {"code": "package main\n\nfunc calculate(a int, b int, c int, d int, e int, f int, g int) int {\n  var result int\n  result = a + b\n  result = result + c\n  result = result + d\n  result = result + e\n  result = result + f\n  result = result + g\n  if result > 100 {\n    result = result - 50\n  }\n  if result < 0 {\n    result = 0\n  }\n  return result\n}"}, "outputs": {"expected_findings": [{"type": "too_many_parameters", "severity": "medium"}, {"type": "poor_naming", "severity": "medium"}, {"type": "code_duplication", "severity": "low"}]}, "metadata": {"category": "maintainability", "difficulty": "low"}}
{"inputs": {"code": "package utils\n\nfunc ProcessData(data string) string {\n  data = cleanData(data)\n  data = validateData(data)\n  data = transformData(data)\n  data = enrichData(data)\n  data = formatData(data)\n  return data\n}\n\nfunc cleanData(d string) string { return d }\nfunc validateData(d string) string { return d }\nfunc transformData(d string) string { return d }\nfunc enrichData(d string) string { return d }\nfunc formatData(d string) string { return d }"}, "outputs": {"expected_findings": [{"type": "missing_error_handling", "severity": "high"}, {"type": "stub_functions", "severity": "high"}]}, "metadata": {"category": "maintainability", "difficulty": "medium"}}
{"inputs": {"code": "package main\n\nimport \"os/exec\"\n\nfunc RunCommand(userInput string) string {\n  cmd := exec.Command(\"sh\", \"-c\", userInput)\n  output, _ := cmd.Output()\n  return string(output)\n}"}, "outputs": {"expected_findings": [{"type": "command_injection", "severity": "critical"}, {"type": "ignored_error", "severity": "medium"}]}, "metadata": {"category": "security", "difficulty": "high"}}
{"inputs": {"code": "package main\n\nimport (\n  \"net/http\"\n  \"fmt\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n  name := r.URL.Query().Get(\"name\")\n  fmt.Fprintf(w, \"<h1>Hello %s</h1>\", name)\n}"}, "outputs": {"expected_findings": [{"type": "xss_vulnerability", "severity": "critical"}, {"type": "missing_input_validation", "severity": "high"}]}, "metadata": {"category": "security", "difficulty": "high"}}
{"inputs": {"code": "package cache\n\nimport \"sync\"\n\ntype Cache struct {\n  data map[string][]byte\n  mu   sync.Mutex\n}\n\nfunc (c *Cache) Get(key string) []byte {\n  c.mu.Lock()\n  defer c.mu.Unlock()\n  return c.data[key]\n}\n\nfunc (c *Cache) Set(key string, value []byte) {\n  c.mu.Lock()\n  c.data[key] = value\n  c.mu.Unlock()\n}"}, "outputs": {"expected_findings": [{"type": "inefficient_locking", "severity": "high"}, {"type": "unbounded_growth", "severity": "medium"}, {"type": "missing_defer", "severity": "high"}]}, "metadata": {"category": "performance", "difficulty": "medium"}}
{"inputs": {"code": "package main\n\nfunc CalculateTotal(items []Item) float64 {\n  var total float64\n  for i := 0; i < len(items); i++ {\n    total = total + items[i].Price\n    total = total + items[i].Tax\n    total = total - items[i].Discount\n  }\n  if total < 0 {\n    total = 0\n  }\n  return total\n}"}, "outputs": {"expected_findings": [{"type": "verbose_loop", "severity": "low"}, {"type": "code_duplication", "severity": "low"}]}, "metadata": {"category": "maintainability", "difficulty": "low"}}
